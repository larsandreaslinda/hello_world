<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[function ($scope, spUtil, cabrillo, $timeout) {
  $scope.got = false;
  $scope.need = false;

  $scope.$on("need_barcode", function() {
    $scope.need = true;
  });

  $scope.$on('scan_barcode', function(evt) {
    $timeout(function() {
      angular.element('#scan_barcode').trigger('click');
    }, 100);
  });

  $scope.getBarcode = function() {
    cabrillo.camera.getBarcode().then(function(value) {
      cabrillo.log('Received barcode value: ' + value);
      $scope.data.barcode = value;
      $scope.got = true;
      $scope.need = false;
      spUtil.update($scope);
    }, function(err) {
      $scope.data.barcode = "IT1011717";
      spUtil.update($scope);
      $scope.got = true;
      $scope.need = false;
    });
  }
}]]></client_script>
        <controller_as>c</controller_as>
        <css/>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>false</has_preview>
        <id>hello_world_barcode</id>
        <internal>false</internal>
        <link><![CDATA[function link(scope, element, attrs, controller) {  }]]></link>
        <name>hello_world_barcode</name>
        <option_schema/>
        <public>false</public>
        <roles/>
        <script><![CDATA[// populate the 'data' variable
var gr = $sp.getRecord();
if (gr == null)
	return;

data.table = gr.getTableName();
data.sys_id = gr.getUniqueValue();

if (input && input.barcode && gr.comments.canWrite()) {
  gr.comments = "scanned: " + input.barcode;
  gr.update();
}]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2023-08-18 11:56:38</sys_created_on>
        <sys_id>6c68a9a8973431104b1a3e2e6253af47</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>hello_world_barcode</sys_name>
        <sys_package display_value="Hello World " source="x_1109822_hello_2">77852524973431104b1a3e2e6253af72</sys_package>
        <sys_policy/>
        <sys_scope display_value="Hello World ">77852524973431104b1a3e2e6253af72</sys_scope>
        <sys_update_name>sp_widget_6c68a9a8973431104b1a3e2e6253af47</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2023-08-18 11:56:38</sys_updated_on>
        <template><![CDATA[<div>
  <div ng-show="false" style="padding-bottom: 16px"><button id="scan_barcode" class="btn btn-primary" style="border-color:#278efc" ng-click="getBarcode()">${Scan Barcode}</button></div>
</div>]]></template>
    </sp_widget>
</record_update>
